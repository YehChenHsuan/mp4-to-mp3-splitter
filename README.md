# MP4 轉 MP3 並分割工具

一個基於 Web 的應用程式，可將 MP4 影片轉換為 MP3 音訊，並自動分割為指定時長的音檔片段。所有處理都在瀏覽器中完成，無需上傳檔案至伺服器。

## ✨ 功能特色

- 🎥 **MP4 轉 MP3**: 輕鬆將 MP4 影片轉換為高品質 MP3 音訊
- ✂️ **自訂分割**: 可選擇分割時長（15/30/45/60 分鐘）
- 🎵 **音質選擇**: 支援 128k/192k/256k/320k 多種音訊品質
- 💾 **本地處理**: 所有處理在瀏覽器中完成，保護隱私
- 🔒 **完全私密**: 檔案不會上傳至任何伺服器，確保資料安全
- 📱 **響應式設計**: 支援桌面和行動裝置
- 🚀 **GitHub Pages 部署**: 可直接部署為靜態網站
- 🎨 **現代化 UI**: 美觀的使用者介面
- 🛡️ **安全保護**: 檔案大小限制與記憶體管理

## 🚀 快速開始

### 本機端使用

1. **安裝依賴**

```bash
npm install
```

2. **啟動開發伺服器**

```bash
npm run dev
```

3. **開啟瀏覽器**
   訪問 `http://localhost:8080`

### GitHub Pages 部署

1. **準備 Git 儲存庫**

```bash
git init
git add .
git commit -m "Initial commit"
```

2. **推送到 GitHub**

```bash
git branch -M main
git remote add origin https://github.com/你的用戶名/mp4-to-mp3-splitter.git
git push -u origin main
```

3. **啟用 GitHub Pages**

   - 前往 GitHub 儲存庫的 **Settings**
   - 選擇左側選單的 **Pages**
   - 設定：
     - **Source**: Deploy from a branch
     - **Branch**: main
     - **Folder**: / (root)
   - 點擊 **Save**

4. **等待部署完成**
   - 通常 1-2 分鐘內完成
   - 訪問 `https://你的用戶名.github.io/mp4-to-mp3-splitter/`

**注意**: GitHub Pages 使用 HTTPS，不會有本地測試時的 CORS 問題，所有功能都能正常運作。

## 📖 使用方法

1. **選擇 MP4 檔案**

   - 點擊「選擇檔案」按鈕
   - 或直接拖放 MP4 檔案到上傳區域

2. **查看檔案資訊與設定**

   - 檔案名稱、大小
   - 音訊長度（自動計算）
   - 預計生成的分割檔數量
   - **設定分割時長**：選擇 15/30/45/60 分鐘
   - **設定音訊品質**：選擇 128k/192k/256k/320k

3. **開始處理**

   - 點擊「開始處理」按鈕
   - 等待轉換和分割完成
   - 查看進度條

4. **下載結果**
   - 個別下載：點擊每個分割檔的「下載」按鈕
   - 全部下載：點擊「下載全部」按鈕（將逐一下載所有檔案）

## 🛠️ 技術架構

### 核心技術

- **HTML5**: 頁面結構
- **CSS3**: 現代化樣式設計
- **JavaScript (ES6+)**: 應用程式邏輯
- **FFmpeg.wasm**: 音訊處理引擎（WebAssembly）

### 依賴套件

- `@ffmpeg/ffmpeg`: FFmpeg WebAssembly 版本
- `@ffmpeg/util`: FFmpeg 工具函式

## 📋 系統需求

### 瀏覽器支援

- Chrome/Edge 90+
- Firefox 88+
- Safari 14+
- 需要支援 WebAssembly 和 File API

### 建議配置

- 現代瀏覽器（最新版本）
- 足夠的記憶體（處理大型檔案時）
- 穩定的網路連線（首次載入 FFmpeg.wasm）

## 📁 檔案結構

```
mp4-to-mp3-splitter/
├── README.md            # 使用說明
├── index.html           # 主頁面
├── app.js               # 主要應用程式邏輯
├── style.css            # 樣式表
├── package.json         # 依賴管理
├── .gitignore           # Git 忽略檔案
├── 404.html             # 404 錯誤頁面
└── .github/             # GitHub 配置
    └── workflows/
        └── deploy.yml   # GitHub Pages 自動部署配置
```

## ⚙️ 配置選項

### UI 設定選項

應用程式提供使用者友善的設定選項：

**分割時長**：
- 15 分鐘
- 30 分鐘（預設）
- 45 分鐘
- 60 分鐘

**音訊品質**：
- 128 kbps（較小檔案）
- 192 kbps（預設，平衡品質與大小）
- 256 kbps（高品質）
- 320 kbps（最高品質）

### 檔案大小限制

- **建議上限**: 2GB（最佳效能）
- **硬限制**: 4GB（超過會被阻止）
- 處理 2-4GB 檔案時會顯示警告，使用者可選擇繼續
- 大檔案可能導致瀏覽器變慢或記憶體不足

## 🔒 安全性說明

### 隱私保護

- ✅ **完全本地處理**: 所有檔案處理都在您的瀏覽器中完成
- ✅ **無伺服器上傳**: 檔案絕不會上傳至任何伺服器
- ✅ **無資料收集**: 不會收集或儲存任何使用者資料
- ✅ **HTTPS 部署**: GitHub Pages 使用 HTTPS 確保傳輸安全

### 檔案安全

- ✅ **檔案類型驗證**: 僅接受 MP4 格式檔案
- ✅ **檔案大小限制**: 2GB 建議上限，4GB 硬限制
- ✅ **輸入驗證**: 所有使用者輸入都經過驗證
- ✅ **記憶體管理**: 自動清理 blob URLs 防止記憶體洩漏

### 程式碼安全

- ✅ **無外部 API 呼叫**: 不依賴任何外部服務處理檔案
- ✅ **CDN 資源驗證**: 僅從受信任的 CDN 載入資源
- ✅ **XSS 防護**: 所有使用者輸入都經過適當處理

## 🔧 故障排除

### FFmpeg 載入失敗

**問題**: 控制台顯示 FFmpeg 載入錯誤

**解決方法**:

- 確保網路連線正常（需要載入 CDN 資源）
- 重新整理頁面（Ctrl+F5 強制重新載入）
- 清除瀏覽器快取
- 如果在 HTTP localhost 環境測試，應用程式會自動使用備用方案

### 本地測試 CORS 錯誤

**問題**: 在 `http://localhost:8080` 測試時出現 CORS 錯誤

**原因**: HTTP → HTTPS 混合內容限制

**解決方法**:

- ✅ **推薦**: 部署到 GitHub Pages（使用 HTTPS，無此問題）
- 或使用 HTTPS 本地伺服器
- 應用程式已自動處理，會使用 blob URL 備用方案

### 處理大型檔案時瀏覽器卡住

- 這是正常現象，請耐心等待
- 關閉其他分頁以釋放記憶體
- 建議檔案大小不超過 2GB

### 下載失敗或部分檔案未下載

- 檢查瀏覽器的下載設定，確保允許多個下載
- 確保有足夠的磁碟空間
- 嘗試個別下載而非全部下載
- 注意：「下載全部」功能會逐一觸發下載，某些瀏覽器可能阻擋多個下載，請在瀏覽器設定中允許

## 📝 開發計畫

### 已完成功能 ✅

- ✅ 支援自訂分割時長（UI 選項）
- ✅ 音訊品質選項（位元率選擇器）
- ✅ 檔案大小限制與警告
- ✅ 記憶體管理與 blob URL 清理
- ✅ 自動計算音訊時長與預計分割檔數

### 未來功能

- [ ] 支援批次處理多個檔案
- [ ] 音訊預覽功能
- [ ] 進度保存（中斷後繼續）
- [ ] ZIP 打包下載（需整合 JSZip）
- [ ] 深色模式支援
- [ ] 進階 FFmpeg 選項（採樣率、聲道等）

## 📄 授權

MIT License

## 🤝 貢獻

歡迎提交 Issue 和 Pull Request！

## 📧 聯絡方式

如有問題或建議，請在 GitHub 上開啟 Issue。

---

**重要提示**: 所有處理都在瀏覽器中完成，檔案不會上傳至任何伺服器。這確保了您的隱私和安全。此應用程式不收集任何使用者資料，所有檔案處理完全在本地進行。
