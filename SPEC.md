# MP4 轉 MP3 並分割應用程式 - 規格文件

## 專案概述

建立一個 Web 應用程式，提供 MP4 轉 MP3 及自動分割為 30 分鐘音檔的功能，可部署於 GitHub Pages 供網頁使用，同時支援本機端使用。

## 功能需求

### 1. 使用者介面（UI）

- [x] 響應式設計，支援桌面和行動裝置
- [x] 檔案選擇器（支援拖放）
- [x] 進度條顯示轉換和分割進度
- [x] 檔案列表顯示生成的 MP3 分割檔
- [x] 下載按鈕（個別或全部下載）

### 2. MP4 轉 MP3 功能

- [x] 支援 MP4 檔案上傳
- [x] 使用 FFmpeg.wasm 進行轉換
- [x] 保持音訊品質（192kbps, 44.1kHz）
- [x] 即時進度回饋

### 3. MP3 分割功能

- [x] 自動將 MP3 檔案分割為 30 分鐘（1800 秒）片段
- [x] 生成檔名格式：`原檔名_part1.mp3`, `原檔名_part2.mp3` ...
- [x] 最後一個片段可以是任意長度（不滿 30 分鐘）
- [x] 所有分割檔保存在本機端（瀏覽器下載）

### 4. 部署需求

- [x] 靜態網站（HTML/CSS/JS），可部署於 GitHub Pages
- [x] 無需後端伺服器
- [x] 所有處理在瀏覽器端完成（使用 FFmpeg.wasm）
- [x] 支援離線使用（Service Worker）

## 技術架構

### 前端技術棧

- **HTML5**: 結構
- **CSS3**: 樣式（現代化 UI）
- **JavaScript (ES6+)**: 主要邏輯
- **FFmpeg.wasm**: 音訊處理引擎
- **File System Access API**: 檔案處理

### 核心函式庫

- `@ffmpeg/ffmpeg`: FFmpeg WebAssembly 版本
- `@ffmpeg/util`: FFmpeg 工具函式

## 檔案結構

```
MP4_to_3_Split_30min/
├── SPEC.md                 # 規格文件（本文件）
├── index.html              # 主頁面
├── app.js                  # 主要應用程式邏輯
├── style.css               # 樣式表
├── package.json            # 依賴管理
├── README.md               # 使用說明
├── .github/
│   └── workflows/
│       └── deploy.yml      # GitHub Pages 部署配置
└── assets/                 # 靜態資源
    └── icons/              # 圖示
```

## 處理流程

1. **使用者上傳 MP4 檔案**

   - 檔案驗證（格式、大小）
   - 顯示檔案資訊（名稱、大小）

2. **轉換為 MP3**

   - 載入 FFmpeg.wasm
   - 執行轉換指令
   - 顯示進度（0-50%）

3. **分割 MP3 檔案**

   - 取得音訊總長度
   - 計算分割點（每 1800 秒）
   - 逐一生成分割檔
   - 顯示進度（50-100%）

4. **下載結果**
   - 生成下載連結
   - 支援個別下載或全部打包下載（ZIP）

## 效能考量

- 大型檔案處理時顯示警告
- 使用 Web Worker 避免阻塞 UI
- 記憶體管理（處理完成後清理）
- 進度回饋以改善使用者體驗

## 瀏覽器相容性

- Chrome/Edge 90+
- Firefox 88+
- Safari 14+
- 需要支援 WebAssembly 和 File API

## 安全性

- 所有處理在本地瀏覽器完成
- 不傳送檔案至伺服器
- 上傳檔案僅存在記憶體中
- 處理完成後自動清理

## 測試計畫

1. 單元測試：各功能函式
2. 整合測試：完整流程
3. 效能測試：大型檔案處理
4. 瀏覽器相容性測試

## 未來擴充

- [ ] 支援自訂分割時長
- [ ] 支援批次處理多個檔案
- [ ] 音訊品質選項（位元率選擇）
- [ ] 預覽功能
- [ ] 進度保存（中斷後繼續）

## 版本歷史

- **v1.0.0** (當前): 基本功能實現
  - MP4 轉 MP3
  - 自動分割為 30 分鐘片段
  - Web UI
  - GitHub Pages 部署
